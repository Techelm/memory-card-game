<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memory Match â€” Pro Web Game</title>
  <style>
    :root {
      --bg: radial-gradient(1200px 800px at 10% 10%, #1b2a4a 0%, #0f172a 35%, #0b1020 100%);
      --primary: #6ee7ff;
      --primary-2: #a78bfa; /* accent */
      --card: rgba(255, 255, 255, 0.08);
      --card-hover: rgba(255, 255, 255, 0.12);
      --text: #e6f0ff;
      --muted: #9fb0c7;
      --success: #34d399;
      --danger: #fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35), 0 2px 8px rgba(0,0,0,.25);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: var(--bg), #0b1020;
      background-attachment: fixed;
      overflow-x: hidden;
    }

    /* Subtle animated gradient sheen */
    .sheen::before {
      content: "";
      position: fixed;
      inset: -10% -10%;
      background: conic-gradient(from 180deg at 50% 50%, rgba(110,231,255,.08), rgba(167,139,250,.08), rgba(110,231,255,.08));
      filter: blur(60px) saturate(120%);
      pointer-events: none;
      animation: float 18s linear infinite;
      opacity: .5;
    }
    @keyframes float {
      0% { transform: rotate(0deg) scale(1); }
      100% { transform: rotate(360deg) scale(1.05); }
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: clamp(16px, 4vw, 32px);
      position: relative;
    }

    header {
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: space-between;
      margin-bottom: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 42px; height: 42px;
      display: grid; place-items: center;
      background: linear-gradient(140deg, rgba(110,231,255,.2), rgba(167,139,250,.18));
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
      font-size: 22px;
    }
    h1 { font-size: clamp(18px, 2.4vw, 28px); margin: 0; letter-spacing: .3px; }
    .subtitle { color: var(--muted); font-size: .95rem; }

    .panel {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
    }

    .controls { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }

    .stat {
      padding: 8px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      font-variant-numeric: tabular-nums;
    }

    select, button, .toggle {
      -webkit-tap-highlight-color: transparent;
      appearance: none;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      cursor: pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      outline: none;
      font-weight: 600;
    }
    select:hover, button:hover, .toggle:hover {
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border-color: rgba(255,255,255,.2);
    }
    button:active { transform: translateY(1px) scale(.99); }

    .btn-primary {
      border: 1px solid rgba(110,231,255,.35);
      background: linear-gradient(180deg, rgba(110,231,255,.22), rgba(110,231,255,.12));
      text-shadow: 0 1px 0 rgba(0,0,0,.35);
    }

    .badges { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .badge {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 10px; border-radius: 999px; font-size: .9rem;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
    }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--primary); box-shadow: 0 0 10px var(--primary); }

    /* Board */
    .board-wrap { margin-top: 18px; }
    .board {
      --cols: 4;
      display: grid;
      grid-template-columns: repeat(var(--cols), minmax(70px, 1fr));
      gap: clamp(10px, 1.5vw, 16px);
      perspective: 1200px;
    }

    .card {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      border: 1px solid rgba(255,255,255,.16);
      border-radius: 18px;
      background: var(--card);
      backdrop-filter: blur(6px);
      box-shadow: var(--shadow);
      overflow: hidden;
      transform-style: preserve-3d;
      transition: transform .25s ease;
    }
    .card:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
    .card:hover { background: var(--card-hover); }

    .card-inner {
      position: absolute; inset: 0;
      transform-style: preserve-3d;
      transition: transform .5s cubic-bezier(.2,.8,.2,1);
    }
    .card.is-flipped .card-inner { transform: rotateY(180deg); }
    .card.is-matched .card-inner { transform: rotateY(180deg) scale(1.02); }

    .face {
      position: absolute; inset: 0; display: grid; place-items: center;
      backface-visibility: hidden; -webkit-backface-visibility: hidden;
      font-size: clamp(28px, 6.3vw, 44px);
      user-select: none;
    }
    .face.front {
      background: linear-gradient(160deg, rgba(167,139,250,.18), rgba(110,231,255,.18));
      color: #0b1020;
      font-weight: 800;
      letter-spacing: .06em;
    }
    .face.back { transform: rotateY(180deg); }

    .pulse { animation: pulse .6s ease; }
    @keyframes pulse { 0%{ transform: scale(.98);} 50%{ transform: scale(1.04);} 100%{ transform: scale(1);} }

    .shake { animation: shake .3s ease; }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-4px); }
      75% { transform: translateX(4px); }
    }

    /* Win modal */
    .modal {
      position: fixed; inset: 0; display: none; place-items: center;
      background: rgba(6,10,20,.55);
      z-index: 50;
    }
    .modal[open] { display: grid; }
    .dialog {
      width: min(520px, 92vw);
      border-radius: 18px; padding: 20px 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .dialog h2 { margin: 0 0 8px; font-size: clamp(20px, 2.6vw, 26px); }
    .dialog p { margin: 0 0 14px; color: var(--muted); }
    .dialog .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 14px 0 18px; }
    .dialog .tile {
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      padding: 12px; border-radius: 12px; text-align: center;
      font-variant-numeric: tabular-nums;
    }

    /* Confetti canvas */
    canvas#confetti { position: fixed; inset: 0; pointer-events: none; z-index: 60; }

    /* Responsive tweaks */
    @media (max-width: 680px) {
      .board { gap: 10px; }
      .panel { padding: 8px 10px; }
    }
  </style>
</head>
<body>
  <div class="sheen"></div>
  <canvas id="confetti"></canvas>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">ðŸ§ </div>
        <div>
          <h1>Memory Match <span style="color:var(--primary)">ELmart Games</span></h1>
          <div class="subtitle">Flip, remember, and match the pairs.</div>
        </div>
      </div>

      <div class="panel">
        <div class="controls">
          <label for="difficulty" class="sr-only" style="position:absolute;left:-9999px">Difficulty</label>
          <select id="difficulty" title="Select difficulty">
            <option value="easy">Easy 4Ã—4</option>
            <option value="medium">Medium 5Ã—4</option>
            <option value="hard">Hard 6Ã—4</option>
          </select>
          <button id="newGame" class="btn-primary">New Game</button>
        </div>
        <div class="badges">
          <div class="stat" id="moves">Moves: 0</div>
          <div class="stat" id="time">Time: 00:00</div>
          <div class="badge" id="best"><span class="dot"></span> Best: â€”</div>
        </div>
      </div>
    </header>

    <main class="board-wrap">
      <div id="board" class="board" style="--cols:4" aria-live="polite"></div>
    </main>
  </div>

  <!-- Win Modal -->
  <div id="winModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="winTitle">
    <div class="dialog">
      <h2 id="winTitle">You did it! ðŸŽ‰</h2>
      <p>Great memory! Here are your stats:</p>
      <div class="grid">
        <div class="tile"><div>Moves</div><strong id="winMoves">0</strong></div>
        <div class="tile"><div>Time</div><strong id="winTime">00:00</strong></div>
        <div class="tile"><div>Difficulty</div><strong id="winDiff">Easy</strong></div>
      </div>
      <div style="display:flex; gap:10px; justify-content:flex-end">
        <button id="closeWin">Close</button>
        <button id="playAgain" class="btn-primary">Play Again</button>
      </div>
    </div>
  </div>

  <script>
  (function(){
    'use strict';

    // --- Icons (emojis to avoid external assets) ---
    const ICONS = [
      'ðŸŽ','ðŸŒ','ðŸ‡','ðŸ‘','ðŸ’','ðŸ“','ðŸ','ðŸ‰','ðŸ¥','ðŸ¥‘','ðŸ‹','ðŸŠ','ðŸ¥¥','ðŸ','ðŸ«','ðŸ¥­','ðŸˆ','ðŸ…',
      'â­ï¸','ðŸŒ™','âš¡ï¸','ðŸ’Ž','ðŸŽ²','ðŸŽ¯','ðŸ§©','ðŸŽµ','ðŸŽ§','ðŸš€','ðŸ›¸','ðŸŽ®','ðŸ±','ðŸ¶','ðŸ¼','ðŸ¸','ðŸ¦Š','ðŸ¦„'
    ];

    // Difficulty map
    const DIFFS = {
      easy:   { cols: 4, rows: 4 },   // 8 pairs
      medium: { cols: 5, rows: 4 },   // 10 pairs
      hard:   { cols: 6, rows: 4 }    // 12 pairs
    };

    // DOM refs
    const boardEl = document.getElementById('board');
    const difficultyEl = document.getElementById('difficulty');
    const newGameBtn = document.getElementById('newGame');
    const movesEl = document.getElementById('moves');
    const timeEl = document.getElementById('time');
    const bestEl = document.getElementById('best');
    const winModal = document.getElementById('winModal');
    const winMovesEl = document.getElementById('winMoves');
    const winTimeEl = document.getElementById('winTime');
    const winDiffEl = document.getElementById('winDiff');
    const closeWinBtn = document.getElementById('closeWin');
    const playAgainBtn = document.getElementById('playAgain');
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');

    // Game state
    let state = {
      deck: [],
      cols: 4,
      rows: 4,
      first: null,
      second: null,
      lock: false,
      moves: 0,
      matches: 0,
      totalPairs: 8,
      timerStarted: false,
      startTime: 0,
      tick: 0,
      raf: null,
      intervalId: null,
    };

    // Utils
    const shuffle = arr => arr.map(v=>[Math.random(), v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
    const pad = n => n.toString().padStart(2, '0');
    const fmtTime = ms => {
      const s = Math.floor(ms/1000);
      const m = Math.floor(s/60);
      const r = s % 60;
      return `${pad(m)}:${pad(r)}`;
    }

    // Storage helpers
    function getBest(key){
      try { return JSON.parse(localStorage.getItem('mem-best-'+key)) || null; } catch { return null; }
    }
    function setBest(key, data){
      try { localStorage.setItem('mem-best-'+key, JSON.stringify(data)); } catch {}
    }

    // Timer
    function resetTimer(){
      if (state.intervalId) clearInterval(state.intervalId);
      state.timerStarted = false; state.startTime = 0; state.tick = 0;
      timeEl.textContent = 'Time: 00:00';
    }
    function startTimer(){
      if (state.timerStarted) return;
      state.timerStarted = true;
      state.startTime = performance.now();
      state.intervalId = setInterval(()=>{
        state.tick = performance.now() - state.startTime;
        timeEl.textContent = 'Time: ' + fmtTime(state.tick);
      }, 250);
    }

    // Confetti (simple but pretty)
    let confettiParts = [];
    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function burstConfetti(x, y){
      const colors = ['#6ee7ff','#a78bfa','#34d399','#fbbf24','#fb7185'];
      for (let i=0; i<160; i++){
        confettiParts.push({
          x, y,
          r: Math.random()*5+2,
          a: Math.random()*Math.PI*2,
          v: Math.random()*4+2,
          g: .08 + Math.random()*0.04,
          life: 60 + Math.random()*40,
          color: colors[(Math.random()*colors.length)|0]
        });
      }
      if (!state.raf){ animateConfetti(); }
    }

    function animateConfetti(){
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      confettiParts = confettiParts.filter(p=>p.life>0);
      for (const p of confettiParts){
        p.x += Math.cos(p.a)*p.v;
        p.y += Math.sin(p.a)*p.v + p.g * (60 - p.life);
        p.a += 0.02;
        p.life--;
        ctx.globalAlpha = Math.max(0, p.life/100);
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
      }
      if (confettiParts.length){ state.raf = requestAnimationFrame(animateConfetti); }
      else { cancelAnimationFrame(state.raf); state.raf = null; }
    }

    // Audio (WebAudio tiny blips)
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let audioCtx = null;
    function beep(freq=600, type='sine', dur=0.08, vol=0.05){
      try {
        if (!audioCtx) audioCtx = new AudioCtx();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type; o.frequency.value = freq; g.gain.value = vol;
        o.connect(g); g.connect(audioCtx.destination); o.start();
        setTimeout(()=>{ o.stop(); }, Math.max(10, dur*1000));
      } catch {}
    }

    // Build a new game
    function newGame(diffKey){
      // Reset
      state.lock = false; state.first = null; state.second = null; state.moves = 0; state.matches = 0;
      movesEl.textContent = 'Moves: 0';
      resetTimer();

      // Difficulty
      const cfg = DIFFS[diffKey] || DIFFS.easy;
      state.cols = cfg.cols; state.rows = cfg.rows; state.totalPairs = (cfg.cols * cfg.rows) / 2;
      boardEl.style.setProperty('--cols', cfg.cols);

      // Update best UI
      const best = getBest(diffKey);
      bestEl.innerHTML = best ? `<span class="dot"></span> Best: ${best.moves} in ${fmtTime(best.time)}` : `<span class="dot"></span> Best: â€”`;

      // Build deck
      const uniques = shuffle(ICONS).slice(0, state.totalPairs);
      state.deck = shuffle([...uniques, ...uniques]).map((icon, i) => ({ id: i+1, icon, matched: false }));

      // Render board
      boardEl.innerHTML = '';
      for (const card of state.deck){
        const btn = document.createElement('button');
        btn.className = 'card';
        btn.setAttribute('data-id', card.id);
        btn.setAttribute('aria-label', 'Face down card');
        btn.addEventListener('click', () => onFlip(btn, card));
        btn.addEventListener('keydown', (e)=>{
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); onFlip(btn, card); }
        });

        const inner = document.createElement('div');
        inner.className = 'card-inner';
        const front = document.createElement('div'); front.className = 'face front'; front.textContent = '?';
        const back = document.createElement('div'); back.className = 'face back'; back.textContent = card.icon;
        inner.appendChild(front); inner.appendChild(back); btn.appendChild(inner);
        boardEl.appendChild(btn);
      }
    }

    function onFlip(btn, card){
      if (state.lock) return;
      if (btn.classList.contains('is-flipped')) return; // already flipped
      if (!state.timerStarted) startTimer();

      btn.classList.add('is-flipped');
      btn.setAttribute('aria-label', 'Card: ' + card.icon);
      beep(700, 'triangle', .06, .03);

      if (!state.first){
        state.first = { btn, card };
        return;
      }

      state.second = { btn, card };
      state.lock = true;
      state.moves++;
      movesEl.textContent = 'Moves: ' + state.moves;

      // Check match
      if (state.first.card.icon === state.second.card.icon){
        state.first.btn.classList.add('is-matched', 'pulse');
        state.second.btn.classList.add('is-matched', 'pulse');
        state.first.btn.disabled = true;
        state.second.btn.disabled = true;
        state.matches++;
        beep(900, 'sine', .08, .05);
        resetPick();
        if (state.matches === state.totalPairs){ onWin(); }
      } else {
        // mismatch
        state.first.btn.classList.add('shake');
        state.second.btn.classList.add('shake');
        beep(220, 'square', .08, .04);
        setTimeout(()=>{
          state.first.btn.classList.remove('is-flipped','shake');
          state.second.btn.classList.remove('is-flipped','shake');
          state.first.btn.setAttribute('aria-label', 'Face down card');
          state.second.btn.setAttribute('aria-label', 'Face down card');
          resetPick();
        }, 700);
      }
    }

    function resetPick(){
      state.first = null; state.second = null; state.lock = false;
    }

    function onWin(){
      clearInterval(state.intervalId);
      // Confetti burst from center
      burstConfetti(window.innerWidth/2, window.innerHeight/3);

      const diffKey = difficultyEl.value;
      const t = state.tick;
      winMovesEl.textContent = state.moves.toString();
      winTimeEl.textContent = fmtTime(t);
      winDiffEl.textContent = (diffKey.charAt(0).toUpperCase()+diffKey.slice(1));
      winModal.setAttribute('open', '');

      // Update best
      const best = getBest(diffKey);
      const better = !best || state.moves < best.moves || (state.moves === best.moves && t < best.time);
      if (better){
        setBest(diffKey, { moves: state.moves, time: t });
        bestEl.innerHTML = `<span class="dot"></span> Best: ${state.moves} in ${fmtTime(t)}`;
      }
    }

    // Events
    newGameBtn.addEventListener('click', ()=> newGame(difficultyEl.value));
    difficultyEl.addEventListener('change', ()=> newGame(difficultyEl.value));
    closeWinBtn.addEventListener('click', ()=> winModal.removeAttribute('open'));
    playAgainBtn.addEventListener('click', ()=>{ winModal.removeAttribute('open'); newGame(difficultyEl.value); });

    // Init
    newGame('easy');
  })();
  </script>
</body>
</html>
